{{if eq .Framework "express"}}import express from 'express';
import process from 'node:process';

const app = express();
app.use(express.json());
app.get('/health', (req, res) => res.json({ status: 'ok', service: '{{.Service}}' }));

const server = app.listen(process.env.PORT || {{.Port}}, () =>
  console.log(`[{{.Service}}] listening on :${process.env.PORT || {{.Port}}}`)
);

function shutdown() {
  console.log('[{{.Service}}] graceful shutdown â€” draining...');
  server.close(() => { console.log('[{{.Service}}] stopped'); process.exit(0); });
  setTimeout(() => process.exit(1), 10000);
}
process.on('SIGTERM', shutdown);
process.on('SIGINT', shutdown);
{{else}}import Fastify from 'fastify';
import process from 'node:process';

const app = Fastify({ logger: true });
app.get('/health', async () => ({ status: 'ok', service: '{{.Service}}' }));

async function shutdown() {
  await app.close();
  process.exit(0);
}
process.on('SIGTERM', shutdown);
process.on('SIGINT', shutdown);

await app.listen({ port: Number(process.env.PORT || {{.Port}}), host: '0.0.0.0' });
{{end}}